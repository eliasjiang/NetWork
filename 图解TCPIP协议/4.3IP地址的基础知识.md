
## IP地址的定义

实际上，IP地址并非是根据主机台数来配置的，而是每一台主机上的每一块网卡（NIC）都得设置IP地址（Windows或Unix中设置IP地址的命令分别为ipconfig/all和ifconfig-a。） 。通常一块网卡只设置一个IP地址，其实一块网卡也可以配置多个IP地址。此外，一台路由器通常都会配置两个以上的网卡，因此可以设置两个以上的IP地址。

因此，让43亿台计算机全部连网其实是不可能的。后面将要详细介绍IP地址的两个组成部分（网络标识和主机标识），了解了这两个组成部分后你会发现实际能够连接到网络的计算机个数更是少了很多（根据一种可以更换IP地址的技术NAT，可连接计算机数超过43亿台。关于NAT的更多细节请参考5.6节。） 。

## IP地址由网络和主机两部分标识组成

IP地址由“网络标识（网络地址）”和“主机标识（主机地址）”两部分组成

网络标识必须保证相互连接的每个段的地址不相重复。而相同段内相连的主机必须有相同的网络地址。IP地址的“主机标识”则不允许在同一个网段内重复出现。

由此，可以通过设置网络地址和主机地址，在相互连接的整个网络中保证每台主机的IP地址都不会相互重叠。即IP地址具有了唯一性（唯一性是指在整个网络中，不会跟其他主机的IP地址冲突。关于唯一性的解释还可以参考1.8.1节。） 。

## IP地址的分类

A类地址

A类IP地址是首位以“0”开头的地址。从第1位到第8位（去掉分类位剩下7位。） 是它的网络标识。用十进制表示的话，0.0.0.0～127.0.0.0是A类的网络地址。A类地址的后24位相当于主机标识。因此，一个网段内可容纳的主机地址上限为16，777，214个（关于A类地址总数的计算请参考附录2.1节。） 。

B类地址

B类IP地址是前两位为“10”的地址。从第1位到第16位（去掉分类位剩下14位。） 是它的网络标识。用十进制表示的话，128.0.0.1～191.255.0.0是B类的网络地址。B类地址的后16位相当于主机标识。因此，一个网段内可容纳的主机地址上限为65，534个（关于B类地址总数的计算请参考附录2.2节。） 。

C类地址

C类IP地址是前三位为“110”的地址。从第1位到第24位（去掉分类位剩下21位。） 是它的网络标识。用十进制表示的话，192.168.0.0～239.255.255.0是C类的网络地址。C类地址的后8位相当于主机标识。因此，一个网段内可容纳的主机地址上限为254个（关于C类地址总数的计算请参考附录2.3节。） 。

D类地址

D类IP地址是前四位为“1110”的地址。从第1位到第32位（去掉分类位剩下28位。） 是它的网络标识。用十进制表示的话，224.0.0.0～239.255.255.255是D类的网络地址。D类地址没有主机标识，常被用于多播。关于多播的更多细节请参考4.3.5节。

在分配IP地址时关于主机标识有一点需要注意。即要用比特位表示主机地址时，不可以全部为0或全部为1。因为全部为只有0在表示对应的网络地址或IP地址不可获知的情况下才使用。而全部为1的主机地址通常作为广播地址。

## 广播地址

## IP多播

### 同时发送提高效率
然而这种方式会给那些毫无关系的网络或主机带来影响，造成网络上很多不必要的流量。况且由于广播无法穿透路由，若想给其他网段发送同样的包，就不得不采取另一种机制。因此，多播这种既可以穿透路由器，又可以实现只给那些必要的组发送数据包的技术就成为必选之路了。

### IP多播与地址

多播使用D类地址。因此，如果从首位开始到第4位是“1110”，就可以认为是多播地址。而剩下的28位可以成为多播的组编号。

从224.0.0.0到239.255.255.255都是多播地址的可用范围。其中从224.0.0.0到224.0.0.255的范围不需要路由控制，在同一个链路内也能实现多播。而在这个范围之外设置多播地址会给全网所有组内成员发送多播的包（可以利用生存时间（TTL，Time To Live）限制包的到达范围。） 。

此外，对于多播，所有的主机（路由器以外的主机和终端主机）必须属于224.0.0.1的组，所有的路由器必须属于224.0.0.2的组。类似地，多播地址中有众多已知的地址，它们中具有代表性的部分已在表4.1中列出。

利用IP多播实现通信，除了地址外还需要IGMP（Internet Group Management Protocol） 等协议的支持。

## 子网掩码

因此，直接使用A类或B类地址，确实有些浪费。随着互联网的覆盖范围逐渐增大，网络地址会越来越不足以应对需求，直接使用A类、B类、C类地址就更加显得浪费资源。为此，人们已经开始一种新的组合方式以减少这种浪费。

现在，一个IP地址的网络标识和主机标识已不再受限于该地址的类别，而是由一个叫做“子网掩码”的识别码通过子网网络地址细分出比A类、B类、C类更小粒度的网络。这种方式实际上就是将原来A类、B类C类等分类中的主机地址部分用作子网地址，可以将原网络分为多个物理网络的一种机制。

自从引入了子网以后，一个IP地址就有了两种识别码。一是IP地址本身，另一个是表示网络部的子网掩码。子网掩码用二进制方式表示的话，也是一个32位的数字。它对应IP地址网络标识部分的位全部为“1”，对应IP地址主机标识的部分则全部为“0”。由此，一个IP地址可以不再受限于自己的类别，而是可以用这样的子网掩码自由地定位自己的网络标识长度。当然，子网掩码必须是IP地址的首位开始连续的“1”（最初提出子网掩码时曾允许出现不连续的子网掩码，但现在基本不允许出现这种情况。） 。

## CIDR与VLSM

## 全局地址与私有地址

然而，随着互联网的迅速普及，IP地址不足的问题日趋显著。如果一直按照现行的方法采用唯一地址的话，会有IP地址耗尽的危险。

于是就出现了一种新技术。它不要求为每一台主机或路由器分配一个固定的IP地址，而是在必要的时候只为相应数量的设备分配唯一的IP地址。

尤其对于那些没有连接互联网的独立网络中的主机，只要保证在这个网络内地址唯一，可以不用考虑互联网即可配置相应的IP地址。不过，即使让每个独立的网络各自随意地设置IP地址，也可能会有问题（例如因运维方案发生变化该网络需要连接到互联网时，或者不小心误被连接到了互联网时，再例如连接两个本来就各自独立的网络时，都容易发生地址冲突。） 。于是又出现了私有网络的IP地址。

## 全局地址由谁决定