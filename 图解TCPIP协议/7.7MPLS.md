
现如今，在转发IP数据包的过程中除了使用路由技术外，还在使用标记交换技术。路由技术基于IP地址中最长匹配原则进行转发，而标记交换则对每个IP包都设定一个叫做“标记”的值，然后根据这个“标记”再进行转发。标记交换技术中最具代表性的当属多协议标记交换技术，即MPLS（Multi Protocol Label Switching）。

MPLS的标记不像MAC地址直接对应到硬件设备。因此，MPLS不需要具备以太网或ATM等数据链路层协议的作用，而只需要关注它与下面一层IP层之间的功能和协议即可。

由于基于标记的转发通常无法在路由器上进行，所以MPLS也就无法被整个互联网采用。

## MPLS的网络基本动作

MPLS网络中实现MPLS功能的路由器叫做标记交换路由器（LSR，Label Switching Router）。特别是与外部网路连接的那部分LSR叫做标记边缘路由器（LER，Label Edge Router）。MPLS正是在LER上对数据包进行追加标记和删除标记的操作。

在一个数据包上附加标记是一个及其简单的动作。如果数据链路本来就有一个相当于标记的信息，那么可以直接进行映射。如果数据链路中没有携带任何相当于标记的信息（最典型的就是以太网），那么就需要追加一个全新的垫片头（Shim Header）。这个垫片头中就包含标记信息（垫片头像个楔子一样介于IP首部与数据链路首部之间。） 。

## MPLS的优点

MPLS的优势可归纳为两点。第一个是转发速度快。通常，路由器转发IP数据包时，首先要对目标地址和路由控制表中可变长的网络地址进行比较，然后从中选出最长匹配的路径才能进行转发。MPLS则不然。它使用固定长度的标记信息，使得处理更加简单，可以通过高速的硬件实现转发（现在的路由器也更趋向于硬件化。） 。此外，相比互联网中的主干路由器需要保存大量路由表才能进行处理的现状，MPLS只需要设置必要的几处信息即可，所要处理的数据量也大幅度减少。而且除了IPv4、IPv6之外，针对其他协议，MPLS仍然可以实现高速转发。

第二个优势在于利用标记生成虚拟的路径，并在它的上面实现IP等数据包的通信。基于这些特点，被称之为“尽力而为”（Best-Effort（尽力而为服务是尽自己最大努力提供服务意思。具体请参考4.2.4节的最后部分。） ）的IP网也可以提供基于MPLS的通信质量控制、带宽保证和VPN等功能。